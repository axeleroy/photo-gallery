# PhotoGallery

A minimal photo gallery intended for use with static websites.

## Goals and functionalities
When working on this project, my goals were to make this photo gallery
* Embeddable in a static website.
* Functionaly minimal: it should just display albums and pictures with relevant EXIF data.
* (relatively) Lightweight with minimal dependancies, with notably no CSS framework involved.
* Fast performance, with small thumbnails and HTTP requests caching.

### What are not goals of this project
* Being user friendly: there's no GUI to manage albums and pictures.
* Handle everyone's use-cases. My main goal was to make a custom solution for my own portfolio,
not to anwser a broad userbase's needs. 

## Using PhotoGallery
### How it works
PhotoGallery fetches all of its data from static JSON files meant to be stored allongside 
the app or pictures.

There are two types of JSON files:

* **Album List**: describes the albums shown by the app
```json5
[
    {
        id: "string",
        name: "string",
        thumbnail: {
            url: "string",
            height: 300, // in pixels
            width: 400 // in pixels
        }
    },
    {
        id: "string",
        name: "string",
        thumbnail: {
            url: "string",
            height: 300, // in pixels
            width: 400 // in pixels
        }
    }
]
```

* **Album Content**: describes an album and the pictures it contains
 ```json5
{
    id: "string",
    name: "string",
    pictures: [
      {
        id: "string",
        thumbnail: {
           url: "string",
           height: 300, // in pixels
           width: 400 // in pixels
        },
        fullsize: {
            url: "string",
            height: 3000, // in pixels
            width: 4000 // in pixels
        }
      },
      {
        id: "string",
        thumbnail: {
           url: "string",
           height: 300,
           width: 400
        },
        fullsize: {
            url: "string",
            height: 3000,
            width: 4000
        }
      }
    ]
}
```

These JSONs are mapped to TypeScript classes you can find in `src/app/types`
and are generated by the Python script in `scripts/`.

Speaking of Python scriptâ€¦

### Uploading pictures and generating JSON files

In order to easily upload pictures and create the JSONs, I created a Python script taking care of everything.

Given a folder containing pictures you want to add to an album, it
* generates thumbnails
* generates a JSON file describing the album (see [How it Works](#how-it-works))
* uploads the JSON, pictures and the thumbnails to the given S3 bucket (all under `s3://bucket-name/album-name/`)
* updates the albums list JSON with the new album on top

It is located in `/scripts` and requires
 * Python 3.6+
 * [ImageMagick](http://docs.wand-py.org/en/0.5.7/guide/install.html)
 * a few dependencies you have to install using `pip install -r requirements.txt`
 * and to set up [your AWS credentials](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html#configuration)

Finally, to list its parameters, just type `python add-album.py -h`.
 
Once it had run, take the created/updated `albums.json` and upload it wherever you want (in a bucket, on your website
allongside the gallery, etc.)

### Building the Angular app

First, install everything using `npm install`. Then modify `src/environments/environment.ts`
or copy it to `src/environments/environment.prod.ts` and make the modifications you need
(refer to [AppConfig.ts](https://github.com/axeleroy/photo-gallery/blob/master/src/environments/AppConfig.ts)).  

The most important attributes to set are
* `albumListUrl`: the URL to the albums list JSON
* `albumBaseUrl`: the URL to the folder containing the albums to display
* `albumFileNameUrl`: Name of the album JSON file, with file extension.

Set the last two variables so that the app fetches the JSON at `albumBaseUrl + albumId + albumFileNameUrl`.

For example, given this configuration
```json5
{
  albumListUrl: 'https://my-wonderful-website.com/assets/albums.json',
  albumBaseUrl: 'https://my-bucket.s3.eu-central-1.amazonaws.com/',
  albumFileNameUrl: '/album.json'
}
```
The app will fetch the albums list at `https://my-wonderful-website.com/assets/albums.json` and for an album with the ID
`fantastic-album` will fetch its content at `https://my-bucket.s3.eu-central-1.amazonaws.com/fantastic-album/album.json`.

Once everything is all set, build the app 
```bash
npm build [--prod] --baseHref=/base-folder --deployUrl=/assets/
```

Then take everything in `/dist/photo-gallery` and deploy anywhere you want !

**Note:** make sure the `assets` folder containing the is at the root of you website.
Edit the code if you want the icons to be stored somewhere else.
